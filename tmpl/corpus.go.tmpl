package {{.Name}}

import (
	"crypto/sha1"
	"encoding/hex"
	"fmt"
	"os"
	"path"
)

func _GoFuzzBuildSaveCorpus(vals ...any) {
	var data []byte
	for _, val := range vals {
		switch v := val.(type) {
		case string:
			data = append(data, []byte(v)...)
		case []byte:
			data = append(data, v...)
		default:
			panic(fmt.Sprintf(`%T not supported`, v))
		}
	}

	hash := sha1.Sum(data)
	fileName := hex.EncodeToString(hash[:])
	f, err := os.OpenFile(path.Join("corpus", fileName), os.O_CREATE|os.O_TRUNC|os.O_WRONLY, 0o644)
	if err != nil {
		panic(err)
	}

	defer f.Close()
	_, err = f.Write(data)
	if err != nil {
		panic(err)
	}
}
